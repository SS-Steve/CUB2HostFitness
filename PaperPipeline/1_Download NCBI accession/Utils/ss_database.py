### Import basic modules

import pandas as pd
import numpy as np


empty_codon_usage = {
    "TTT": 0.0,
    "TTC": 0.0,
    "TTA": 0.0,
    "TTG": 0.0,
    "TCT": 0.0,
    "TCC": 0.0,
    "TCA": 0.0,
    "TCG": 0.0,
    "TAT": 0.0,
    "TAC": 0.0,
    "TAA": 0.0,
    "TAG": 0.0,
    "TGT": 0.0,
    "TGC": 0.0,
    "TGA": 0.0,
    "TGG": 0.0,
    "CTT": 0.0,
    "CTC": 0.0,
    "CTA": 0.0,
    "CTG": 0.0,
    "CCT": 0.0,
    "CCC": 0.0,
    "CCA": 0.0,
    "CCG": 0.0,
    "CAT": 0.0,
    "CAC": 0.0,
    "CAA": 0.0,
    "CAG": 0.0,
    "CGT": 0.0,
    "CGC": 0.0,
    "CGA": 0.0,
    "CGG": 0.0,
    "ATT": 0.0,
    "ATC": 0.0,
    "ATA": 0.0,
    "ATG": 0.0,
    "ACT": 0.0,
    "ACC": 0.0,
    "ACA": 0.0,
    "ACG": 0.0,
    "AAT": 0.0,
    "AAC": 0.0,
    "AAA": 0.0,
    "AAG": 0.0,
    "AGT": 0.0,
    "AGC": 0.0,
    "AGA": 0.0,
    "AGG": 0.0,
    "GTT": 0.0,
    "GTC": 0.0,
    "GTA": 0.0,
    "GTG": 0.0,
    "GCT": 0.0,
    "GCC": 0.0,
    "GCA": 0.0,
    "GCG": 0.0,
    "GAT": 0.0,
    "GAC": 0.0,
    "GAA": 0.0,
    "GAG": 0.0,
    "GGT": 0.0,
    "GGC": 0.0,
    "GGA": 0.0,
    "GGG": 0.0,
}


codon_table_list = [
    "TTT",
    "TTC",
    "TTA",
    "TTG",
    "TCT",
    "TCC",
    "TCA",
    "TCG",
    "TAT",
    "TAC",
    "TAA",
    "TAG",
    "TGT",
    "TGC",
    "TGA",
    "TGG",
    "CTT",
    "CTC",
    "CTA",
    "CTG",
    "CCT",
    "CCC",
    "CCA",
    "CCG",
    "CAT",
    "CAC",
    "CAA",
    "CAG",
    "CGT",
    "CGC",
    "CGA",
    "CGG",
    "ATT",
    "ATC",
    "ATA",
    "ATG",
    "ACT",
    "ACC",
    "ACA",
    "ACG",
    "AAT",
    "AAC",
    "AAA",
    "AAG",
    "AGT",
    "AGC",
    "AGA",
    "AGG",
    "GTT",
    "GTC",
    "GTA",
    "GTG",
    "GCT",
    "GCC",
    "GCA",
    "GCG",
    "GAT",
    "GAC",
    "GAA",
    "GAG",
    "GGT",
    "GGC",
    "GGA",
    "GGG",
]


translation_codon_aa_dict = {
    "TCT": "S",
    "TCC": "S",
    "TCA": "S",
    "TCG": "S",
    "AGT": "S",
    "AGC": "S",
    "CGT": "R",
    "CGC": "R",
    "CGA": "R",
    "CGG": "R",
    "AGA": "R",
    "AGG": "R",
    "CTT": "L",
    "CTC": "L",
    "CTA": "L",
    "CTG": "L",
    "TTA": "L",
    "TTG": "L",
    "GCT": "A",
    "GCC": "A",
    "GCA": "A",
    "GCG": "A",
    "GGT": "G",
    "GGC": "G",
    "GGA": "G",
    "GGG": "G",
    "CCT": "P",
    "CCC": "P",
    "CCA": "P",
    "CCG": "P",
    "ACT": "T",
    "ACC": "T",
    "ACA": "T",
    "ACG": "T",
    "GTT": "V",
    "GTC": "V",
    "GTA": "V",
    "GTG": "V",
    "ATT": "I",
    "ATC": "I",
    "ATA": "I",
    "TTT": "F",
    "TTC": "F",
    "AAT": "N",
    "AAC": "N",
    "GAT": "D",
    "GAC": "D",
    "CAT": "H",
    "CAC": "H",
    "TGT": "C",
    "TGC": "C",
    "TAT": "Y",
    "TAC": "Y",
    "CAA": "Q",
    "CAG": "Q",
    "AAA": "K",
    "AAG": "K",
    "GAA": "E",
    "GAG": "E",
    "ATG": "M",
    "TGG": "W",
    "TAA": "*",
    "TAG": "*",
    "TGA": "*",
}


aa_table_list = [
    "S",
    "R",
    "L",
    "A",
    "G",
    "P",
    "T",
    "V",
    "I",
    "F",
    "N",
    "D",
    "H",
    "C",
    "Y",
    "Q",
    "K",
    "E",
    "M",
    "W",
    "*",
]


translation_aa_codon_dict = {
    "S": ["TCT", "TCC", "TCA", "TCG", "AGT", "AGC"],
    "R": ["CGT", "CGC", "CGA", "CGG", "AGA", "AGG"],
    "L": ["CTT", "CTC", "CTA", "CTG", "TTA", "TTG"],
    "A": ["GCT", "GCC", "GCA", "GCG"],
    "G": ["GGT", "GGC", "GGA", "GGG"],
    "P": ["CCT", "CCC", "CCA", "CCG"],
    "T": ["ACT", "ACC", "ACA", "ACG"],
    "V": ["GTT", "GTC", "GTA", "GTG"],
    "I": ["ATT", "ATC", "ATA"],
    "F": ["TTT", "TTC"],
    "N": ["AAT", "AAC"],
    "D": ["GAT", "GAC"],
    "H": ["CAT", "CAC"],
    "C": ["TGT", "TGC"],
    "Y": ["TAT", "TAC"],
    "Q": ["CAA", "CAG"],
    "K": ["AAA", "AAG"],
    "E": ["GAA", "GAG"],
    "M": ["ATG"],
    "W": ["TGG"],
    "*": ["TAA", "TAG", "TGA"],
}

aa_list_with_2plus_codons = [
    "S",
    "R",
    "L",
    "A",
    "G",
    "P",
    "T",
    "V",
    "I",
    "F",
    "N",
    "D",
    "H",
    "C",
    "Y",
    "Q",
    "K",
    "E",
]

aa_list_with_3plus_codons = ["S", "R", "L", "A", "G", "P", "T", "V", "I"]

# The valid list of codons for analysing codon usage in this paper (total 61 codons)
# The stop codons are removed - Only focus on the amino acids translating codons
CU_valid_codon_list = [
    "TTT",
    "TTC",
    "TTA",
    "TTG",
    "TCT",
    "TCC",
    "TCA",
    "TCG",
    "TAT",
    "TAC",
    "TGT",
    "TGC",
    "TGG",
    "CTT",
    "CTC",
    "CTA",
    "CTG",
    "CCT",
    "CCC",
    "CCA",
    "CCG",
    "CAT",
    "CAC",
    "CAA",
    "CAG",
    "CGT",
    "CGC",
    "CGA",
    "CGG",
    "ATT",
    "ATC",
    "ATA",
    "ATG",
    "ACT",
    "ACC",
    "ACA",
    "ACG",
    "AAT",
    "AAC",
    "AAA",
    "AAG",
    "AGT",
    "AGC",
    "AGA",
    "AGG",
    "GTT",
    "GTC",
    "GTA",
    "GTG",
    "GCT",
    "GCC",
    "GCA",
    "GCG",
    "GAT",
    "GAC",
    "GAA",
    "GAG",
    "GGT",
    "GGC",
    "GGA",
    "GGG",
]

# The valid list of amino acids for analysing amino acid usages in this paper (total 20 amino acids)
# The stop codons are removed - Only focus on the amino acids in translation
AAU_valid_codon_list = [
    "S",
    "R",
    "L",
    "A",
    "G",
    "P",
    "T",
    "V",
    "I",
    "F",
    "N",
    "D",
    "H",
    "C",
    "Y",
    "Q",
    "K",
    "E",
    "M",
    "W",
]

# The valid list of codons for analysing RSCU in this paper (total 59 codons)
# The stop codons are removed - Only focus on the amino acids translating codons
# The ATG (Met) and UGG (Trp) are removed because they only have 1 codon and their RSCU are always equal to 1
RSCU_valid_codon_list = [
    "TTT",
    "TTC",
    "TTA",
    "TTG",
    "TCT",
    "TCC",
    "TCA",
    "TCG",
    "TAT",
    "TAC",
    "TGT",
    "TGC",
    "CTT",
    "CTC",
    "CTA",
    "CTG",
    "CCT",
    "CCC",
    "CCA",
    "CCG",
    "CAT",
    "CAC",
    "CAA",
    "CAG",
    "CGT",
    "CGC",
    "CGA",
    "CGG",
    "ATT",
    "ATC",
    "ATA",
    "ACT",
    "ACC",
    "ACA",
    "ACG",
    "AAT",
    "AAC",
    "AAA",
    "AAG",
    "AGT",
    "AGC",
    "AGA",
    "AGG",
    "GTT",
    "GTC",
    "GTA",
    "GTG",
    "GCT",
    "GCC",
    "GCA",
    "GCG",
    "GAT",
    "GAC",
    "GAA",
    "GAG",
    "GGT",
    "GGC",
    "GGA",
    "GGG",
]


# Homo Sapiens (human) Average codon usage and calculated RSCU (calculated with 'codon_usage_to_RSCU_usage' function in ss_utils.py)
# Codon usage (percentage) data was downloaded from HIVE CoCoPuts - Homo sapiens (9606) Codon Usage Table
# Link: https://dnahive.fda.gov/dna.cgi?cmd=codon_usage&id=537&mode=cocoputs
homo_sapiens_codon_usage = {
    "TTT": 0.01722134388697483,
    "TTC": 0.01750705136342572,
    "TTA": 0.008820619965000899,
    "TTG": 0.013468505403291297,
    "CTT": 0.014166992474560809,
    "CTC": 0.01780941081670945,
    "CTA": 0.007484647606924058,
    "CTG": 0.03601285015517057,
    "ATT": 0.016584933747019123,
    "ATC": 0.018684605952663177,
    "ATA": 0.008160313406331197,
    "ATG": 0.021475904768714027,
    "GTT": 0.011804011685207958,
    "GTC": 0.013439450839562977,
    "GTA": 0.007706294250132557,
    "GTG": 0.0257492679209893,
    "TCT": 0.016960569577987708,
    "TCC": 0.017285199930340722,
    "TCA": 0.014186242722951731,
    "TCG": 0.004054365978093985,
    "CCT": 0.019151693262855922,
    "CCC": 0.01885894613440037,
    "CCA": 0.018788140034600786,
    "CCG": 0.006151247921670739,
    "ACT": 0.014304956854484838,
    "ACC": 0.01777157588702623,
    "ACA": 0.01656501793152958,
    "ACG": 0.005590635634754286,
    "GCT": 0.01889099575007249,
    "GCC": 0.025643532347879326,
    "GCA": 0.01709245425845317,
    "GCG": 0.005942643833721781,
    "TAT": 0.012151117726506755,
    "TAC": 0.01346501117602353,
    "TAA": 0.0004416037699358785,
    "TAG": 0.0003501138926098783,
    "CAT": 0.011903270778473645,
    "CAC": 0.014622585952935037,
    "CAA": 0.014165725337199972,
    "CAG": 0.03528167349986488,
    "AAT": 0.018515705502020495,
    "AAC": 0.018270008847690627,
    "AAA": 0.027765398656388978,
    "AAG": 0.03179300115749798,
    "GAT": 0.024090674711222594,
    "GAC": 0.024248606104105293,
    "GAA": 0.033853891280280005,
    "GAG": 0.039397079660522895,
    "TGT": 0.010472583102515944,
    "TGC": 0.010828853490788078,
    "TGA": 0.0008041074500739561,
    "TGG": 0.011659007653279272,
    "CGT": 0.004558289867322015,
    "CGC": 0.008707755144315299,
    "CGA": 0.006416041231984155,
    "CGG": 0.010615680028719732,
    "AGT": 0.014061384895123649,
    "AGC": 0.019660788096465556,
    "AGA": 0.013396355369927185,
    "AGG": 0.012174322979387565,
    "GGT": 0.010815990126670474,
    "GGC": 0.019725706487315788,
    "GGA": 0.017192839696039602,
    "GGG": 0.015260404023291674,
}

homo_sapiens_aa_usage = {
    "S": 0.08620855120096335,
    "R": 0.05586844462165595,
    "L": 0.09776302642165707,
    "A": 0.06756962619012677,
    "G": 0.06299494033331754,
    "P": 0.06295002735352782,
    "T": 0.05423218630779493,
    "V": 0.05869902469589279,
    "I": 0.043429853106013494,
    "F": 0.03472839525040055,
    "N": 0.03678571434971112,
    "D": 0.04833928081532789,
    "H": 0.026525856731408684,
    "C": 0.021301436593304024,
    "Y": 0.025616128902530285,
    "Q": 0.04944739883706485,
    "K": 0.059558399813886956,
    "E": 0.0732509709408029,
    "M": 0.021475904768714027,
    "W": 0.011659007653279272,
    "*": 0.001595825112619713,
}


homo_sapiens_RSCU = {
    "TTT": 0.9917730872851779,
    "TTC": 1.0082269127148222,
    "TTA": 0.5413469869656305,
    "TTG": 0.8266011740594603,
    "CTT": 0.8694693480615765,
    "CTC": 1.0930151081798465,
    "CTA": 0.4593544951018013,
    "CTG": 2.2102128876316853,
    "ATT": 1.1456359550561799,
    "ATC": 1.2906748204089151,
    "ATA": 0.5636892245349052,
    "ATG": 1.0,
    "GTT": 0.8043753194443718,
    "GTC": 0.9158210657972546,
    "GTA": 0.5251395088798995,
    "GTG": 1.7546641058784742,
    "TCT": 1.1804329854784648,
    "TCC": 1.2030268243376463,
    "TCA": 0.9873435425134396,
    "TCG": 0.2821784559614786,
    "CCT": 1.2169458262694546,
    "CCC": 1.1983439516865266,
    "CCA": 1.1938447574668365,
    "CCG": 0.39086546457718185,
    "ACT": 1.0550898149889818,
    "ACC": 1.310777019843058,
    "ACA": 1.2217849995952421,
    "ACG": 0.41234816557271853,
    "GCT": 1.1183128760793903,
    "GCC": 1.5180508636068992,
    "GCA": 1.0118424636749408,
    "GCG": 0.3517937966387694,
    "TAT": 0.9487083526743577,
    "TAC": 1.0512916473256422,
    "TAA": 0.8301732435033685,
    "TAG": 0.6581809432146294,
    "CAT": 0.8974843601849998,
    "CAC": 1.1025156398150002,
    "CAA": 0.5729613961647506,
    "CAG": 1.4270386038352494,
    "AAT": 1.0066791323390951,
    "AAC": 0.9933208676609051,
    "AAA": 0.9323755756753911,
    "AAG": 1.0676244243246091,
    "GAT": 0.9967328559668471,
    "GAC": 1.0032671440331529,
    "GAA": 0.9243260763775736,
    "GAG": 1.0756739236224262,
    "TGT": 0.983274818732924,
    "TGC": 1.016725181267076,
    "TGA": 1.5116458132820019,
    "TGG": 1.0,
    "CGT": 0.48953822482701925,
    "CGC": 0.9351706713818158,
    "CGA": 0.6890517116165225,
    "CGG": 1.1400725508586835,
    "AGT": 0.9786536044906773,
    "AGC": 1.3683645872182935,
    "AGA": 1.438703596706299,
    "AGG": 1.30746324460966,
    "GGT": 0.6867846890204914,
    "GGC": 1.2525264018312285,
    "GGA": 1.0916965461079382,
    "GGG": 0.9689923630403418,
}
